
/*
    Taken from: https://en.wikipedia.org/wiki/Blackjack#Basic_strategy
    Each value is a bitmap of the preferred actions for each case,
    with the following values and decreasing order of priority:

    Surrender:  00001
    Split:      00010
    Double:     00100
    Hit:        01000
    Stand:      10000
*/

use crate::Hand;

static STRATEGY: [u8; 360] = [
/*           Dealer's face up card          */
/*   A   2   3   4   5   6   7   8   9  10  */
// 0 -------------------------------------  // Hard hands
     8,  8,  8,  8,  8,  8,  8,  8,  8,  8, // 5
     8,  8,  8,  8,  8,  8,  8,  8,  8,  8, // 6
     8,  8,  8,  8,  8,  8,  8,  8,  8,  8, // 7
     8,  8,  8,  8,  8,  8,  8,  8,  8,  8, // 8
     8,  8, 12, 12, 12, 12,  8,  8,  8,  8, // 9
     8, 12, 12, 12, 12, 12, 12, 12, 12,  8, // 10
    12, 12, 12, 12, 12, 12, 12, 12, 12, 12, // 11
     8,  8,  8, 16, 16, 16,  8,  8,  8,  8, // 12
     8, 16, 16, 16, 16, 16,  8,  8,  8,  8, // 13
     8, 16, 16, 16, 16, 16,  8,  8,  8,  8, // 14
     9, 16, 16, 16, 16, 16,  8,  8,  8,  9, // 15
     9, 16, 16, 16, 16, 16,  8,  8,  9,  9, // 16
    17, 16, 16, 16, 16, 16, 16, 16, 16, 16, // 17
    16, 16, 16, 16, 16, 16, 16, 16, 16, 16, // 18
    16, 16, 16, 16, 16, 16, 16, 16, 16, 16, // 19
    16, 16, 16, 16, 16, 16, 16, 16, 16, 16, // 20
    16, 16, 16, 16, 16, 16, 16, 16, 16, 16, // 21
// 170 -----------------------------------  // Soft hands
     8,  8,  8,  8, 12, 12,  8,  8,  8,  8, // 13
     8,  8,  8,  8, 12, 12,  8,  8,  8,  8, // 14
     8,  8,  8, 12, 12, 12,  8,  8,  8,  8, // 15
     8,  8,  8, 12, 12, 12,  8,  8,  8,  8, // 16
     8,  8, 12, 12, 12, 12,  8,  8,  8,  8, // 17
     8, 20, 20, 20, 20, 20, 16, 16,  8,  8, // 18
    16, 16, 16, 16, 16, 20, 16, 16, 16, 16, // 19
    16, 16, 16, 16, 16, 16, 16, 16, 16, 16, // 20
    16, 16, 16, 16, 16, 16, 16, 16, 16, 16, // 21
// 260 -----------------------------------  // Doubles
    10, 10, 10, 10, 10, 14, 10, 10, 10,  10, // A-A
     8,  2,  2,  2,  2,  2,  2,  8,  8,  8, // 2-2
     8,  2,  2,  2,  2,  2,  2,  8,  8,  8, // 3-3
     8,  8,  8,  8,  2,  2,  8,  8,  8,  8, // 4-4
     8, 12, 12, 12, 12, 12, 12, 12, 12,  8, // 5-5
     8,  2,  2,  2,  2,  2,  8,  8,  8,  8, // 6-6
     8,  2,  2,  2,  2,  2,  2,  8,  8,  8, // 7-7
     3,  2,  2,  2,  2,  2,  2,  2,  2,  2, // 8-8
    16,  2,  2,  2,  2,  2, 16,  2,  2, 16, // 9-9
    16, 16, 16, 16, 16, 16, 16, 16, 16, 16, // 10-10
];

pub fn best_actions(hand: Hand, dealer: u8) -> u8 {
    match hand {
        Hand::Hard(x) => STRATEGY[(x as usize - 5) * 10 + dealer as usize - 1],
        Hand::Soft(x) => STRATEGY[170 + (x as usize - 13) * 10 + dealer as usize - 1],
        Hand::Doubles(x) => STRATEGY[260 + (x as usize - 1) * 10 + dealer as usize - 1],
    }
}
